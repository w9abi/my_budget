<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أداة تخطيط الميزانية الشهرية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The application uses a two-column dashboard layout. The left column is dedicated to user inputs (income, savings, fixed and variable expenses), organized into logical sections for clear data entry. The right column serves as a real-time summary dashboard, featuring key metric cards (Total Income, Total Expenses, Remaining Balance) and a dynamic donut chart visualizing the expense breakdown. This structure was chosen to separate the task of data entry from the goal of data analysis, providing immediate visual feedback and making it intuitive for the user to see the impact of their financial decisions instantly. -->
    <!-- Visualization & Content Choices: Report Info: Budget categories (Income, Savings, Expenses). Goal: Inform, Compare, Organize. Viz/Presentation: Input fields for data entry, summary cards for key metrics, and a donut chart for expense proportions. Interaction: Real-time updates to all summary elements and the chart as the user types into the input fields. Justification: This combination provides a comprehensive yet easy-to-understand overview of personal finances. The donut chart is ideal for showing part-to-whole relationships in spending. Library/Method: Vanilla JS for logic, Chart.js (Canvas) for visualization. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #FDFBF7;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="text-gray-800">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-teal-800">أداة تخطيط الميزانية الشهرية</h1>
            <p class="mt-2 text-lg text-gray-600">أدخل أرقامك المالية أدناه للحصول على تحليل فوري لميزانيتك.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-5 gap-8">
            
            <div class="lg:col-span-3 space-y-6">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4 border-b-2 border-teal-100 pb-2">الدخل</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                        <label for="income" class="font-semibold text-gray-700">الراتب الشهري:</label>
                        <input type="number" id="income" data-category="income" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00">
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4 border-b-2 border-teal-100 pb-2">الادخار والاستثمار</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                            <label for="savings" class="font-semibold text-gray-700">المدخرات للطوارئ:</label>
                            <input type="number" id="savings" data-category="savings" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                            <label for="investment" class="font-semibold text-gray-700">الاستثمار:</label>
                            <input type="number" id="investment" data-category="savings" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00">
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4 border-b-2 border-teal-100 pb-2">المصروفات الثابتة</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="rent" class="font-semibold text-gray-700">الإيجار/قسط المنزل:</label><input type="number" id="rent" data-category="fixed" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="bills" class="font-semibold text-gray-700">الفواتير (ماء، كهرباء، إنترنت):</label><input type="number" id="bills" data-category="fixed" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="loans" class="font-semibold text-gray-700">أقساط القروض:</label><input type="number" id="loans" data-category="fixed" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="subscriptions" class="font-semibold text-gray-700">اشتراكات شهرية:</label><input type="number" id="subscriptions" data-category="fixed" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4 border-b-2 border-teal-100 pb-2">المصروفات المتغيرة</h2>
                     <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="food" class="font-semibold text-gray-700">المأكولات والمشروبات:</label><input type="number" id="food" data-category="variable" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="transport" class="font-semibold text-gray-700">المواصلات:</label><input type="number" id="transport" data-category="variable" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="shopping" class="font-semibold text-gray-700">التسوق والملابس:</label><input type="number" id="shopping" data-category="variable" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center"><label for="entertainment" class="font-semibold text-gray-700">الترفيه:</label><input type="number" id="entertainment" data-category="variable" class="budget-input w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition text-left" placeholder="0.00"></div>
                    </div>
                </div>
            </div>

            <aside class="lg:col-span-2 space-y-6">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">ملخص الميزانية</h2>
                    <p class="text-gray-600 mb-6">هذا الملخص يعرض لك صورة حية وفورية لوضعك المالي بناءً على الأرقام التي أدخلتها. يتم تحديث كل شيء تلقائيًا.</p>
                    <div class="space-y-4 text-center">
                        <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                            <p class="text-lg font-semibold text-green-800">إجمالي الدخل</p>
                            <p id="total-income" class="text-3xl font-bold text-green-600">0.00</p>
                        </div>
                        <div class="p-4 bg-red-50 rounded-lg border border-red-200">
                            <p class="text-lg font-semibold text-red-800">إجمالي المصروفات</p>
                            <p id="total-expenses" class="text-3xl font-bold text-red-600">0.00</p>
                        </div>
                        <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <p class="text-lg font-semibold text-blue-800">الرصيد المتبقي</p>
                            <p id="remaining-balance" class="text-3xl font-bold text-blue-600">0.00</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4 text-center">توزيع المصروفات</h2>
                    <div class="chart-container">
                        <canvas id="expenseChart"></canvas>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const inputs = document.querySelectorAll('.budget-input');
            const totalIncomeEl = document.getElementById('total-income');
            const totalExpensesEl = document.getElementById('total-expenses');
            const remainingBalanceEl = document.getElementById('remaining-balance');
            const remainingBalanceCard = remainingBalanceEl.parentElement;

            const ctx = document.getElementById('expenseChart').getContext('2d');
            const expenseChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['الادخار والاستثمار', 'المصروفات الثابتة', 'المصروفات المتغيرة'],
                    datasets: [{
                        label: 'توزيع المصروفات',
                        data: [0, 0, 0],
                        backgroundColor: [
                            'rgba(20, 184, 166, 0.7)',
                            'rgba(249, 115, 22, 0.7)',
                            'rgba(239, 68, 68, 0.7)'
                        ],
                        borderColor: [
                            'rgba(13, 148, 136, 1)',
                            'rgba(234, 88, 12, 1)',
                            'rgba(220, 38, 38, 1)'
                        ],
                        borderWidth: 1,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                             labels: {
                                font: {
                                    family: 'Tajawal',
                                    size: 14,
                                }
                            }
                        },
                        tooltip: {
                            bodyFont: {
                                family: 'Tajawal'
                            },
                            titleFont: {
                                 family: 'Tajawal'
                            },
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += new Intl.NumberFormat('ar-SA', { style: 'currency', currency: 'SAR', minimumFractionDigits: 2 }).format(context.parsed);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            function calculateTotals() {
                let totals = {
                    income: 0,
                    savings: 0,
                    fixed: 0,
                    variable: 0,
                };

                inputs.forEach(input => {
                    const value = parseFloat(input.value) || 0;
                    const category = input.dataset.category;
                    if (totals.hasOwnProperty(category)) {
                        totals[category] += value;
                    }
                });
                
                return totals;
            }

            function updateUI() {
                const totals = calculateTotals();
                const totalExpenses = totals.savings + totals.fixed + totals.variable;
                const remainingBalance = totals.income - totalExpenses;
                
                const formatCurrency = (value) => new Intl.NumberFormat('ar-SA', { style: 'currency', currency: 'SAR', minimumFractionDigits: 2 }).format(value);

                totalIncomeEl.textContent = formatCurrency(totals.income);
                totalExpensesEl.textContent = formatCurrency(totalExpenses);
                remainingBalanceEl.textContent = formatCurrency(remainingBalance);

                remainingBalanceEl.classList.remove('text-green-600', 'text-red-600', 'text-blue-600');
                if (remainingBalance > 0) {
                    remainingBalanceEl.classList.add('text-green-600');
                } else if (remainingBalance < 0) {
                    remainingBalanceEl.classList.add('text-red-600');
                } else {
                    remainingBalanceEl.classList.add('text-blue-600');
                }

                updateChart(totals.savings, totals.fixed, totals.variable);
            }

            function updateChart(savings, fixed, variable) {
                expenseChart.data.datasets[0].data = [savings, fixed, variable];
                expenseChart.update();
            }

            inputs.forEach(input => {
                input.addEventListener('input', updateUI);
            });

            updateUI();
        });
    </script>
</body>
</html>
